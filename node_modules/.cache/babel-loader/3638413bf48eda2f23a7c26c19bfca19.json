{"remainingRequest":"D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\node_modules\\babel-loader\\lib\\index.js!D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\src\\store\\modules\\admin\\modules\\menu.js","dependencies":[{"path":"D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\src\\store\\modules\\admin\\modules\\menu.js","mtime":1589174872000},{"path":"D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1628602912197},{"path":"D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\node_modules\\babel-loader\\lib\\index.js","mtime":1628602899323},{"path":"D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\node_modules\\eslint-loader\\index.js","mtime":1607701091992}],"contextDependencies":[],"result":["/**\r\n * 菜单\r\n * */\nimport { cloneDeep } from 'lodash';\nimport { includeArray } from '@/libs/system'; // 根据 menu 配置的权限，过滤菜单\n\nfunction filterMenu(menuList, access, lastList) {\n  menuList.forEach(function (menu) {\n    var menuAccess = menu.auth;\n\n    if (!menuAccess || includeArray(menuAccess, access)) {\n      var newMenu = {};\n\n      for (var i in menu) {\n        if (i !== 'children') newMenu[i] = cloneDeep(menu[i]);\n      }\n\n      if (menu.children && menu.children.length) newMenu.children = [];\n      lastList.push(newMenu);\n      menu.children && filterMenu(menu.children, access, newMenu.children);\n    }\n  });\n  return lastList;\n}\n\nexport default {\n  namespaced: true,\n  state: {\n    // 顶部菜单\n    header: [],\n    // 侧栏菜单\n    sider: [],\n    // 当前顶栏菜单的 name\n    headerName: '',\n    // 当前所在菜单的 path\n    activePath: '',\n    // 展开的子菜单 name 集合\n    openNames: [],\n    // 2.3.0 所有的菜单\n    menuSider: []\n  },\n  getters: {\n    /**\r\n     * @description 根据 user 里登录用户权限，对侧边菜单进行鉴权过滤\r\n     * */\n    filterSider: function filterSider(state, getters, rootState) {\n      var userInfo = rootState.admin.user.info; // @权限\n\n      var access = userInfo.access;\n\n      if (access && access.length) {\n        return filterMenu(state.sider, access, []);\n      } else {\n        return filterMenu(state.sider, [], []);\n      }\n    },\n\n    /**\r\n     * @description 根据 user 里登录用户权限，对顶栏菜单进行鉴权过滤\r\n     * */\n    filterHeader: function filterHeader(state, getters, rootState) {\n      var userInfo = rootState.admin.user.info; // @权限\n\n      var access = userInfo.access;\n\n      if (access && access.length) {\n        return state.header.filter(function (item) {\n          var state = true;\n          if (item.auth && !includeArray(item.auth, access)) state = false;\n          return state;\n        });\n      } else {\n        return state.header.filter(function (item) {\n          var state = true;\n          if (item.auth && item.auth.length) state = false;\n          return state;\n        });\n      }\n    },\n\n    /**\r\n     * @description 当前 header 的全部信息\r\n     * */\n    currentHeader: function currentHeader(state) {\n      return state.header.find(function (item) {\n        return item.name === state.headerName;\n      });\n    },\n\n    /**\r\n     * @description 在当前 header 下，是否隐藏 sider（及折叠按钮）\r\n     * */\n    hideSider: function hideSider(state, getters) {\n      var visible = false;\n      if (getters.currentHeader && 'hideSider' in getters.currentHeader) visible = getters.currentHeader.hideSider;\n      return visible;\n    }\n  },\n  mutations: {\n    /**\r\n     * @description 设置侧边栏菜单\r\n     * @param {Object} state vuex state\r\n     * @param {Array} menu menu\r\n     */\n    setSider: function setSider(state, menu) {\n      state.sider = menu;\n    },\n\n    /**\r\n     * @description 设置顶栏菜单\r\n     * @param {Object} state vuex state\r\n     * @param {Array} menu menu\r\n     */\n    setHeader: function setHeader(state, menu) {\n      state.header = menu;\n    },\n\n    /**\r\n     * @description 设置当前顶栏菜单 name\r\n     * @param {Object} state vuex state\r\n     * @param {Array} name headerName\r\n     */\n    setHeaderName: function setHeaderName(state, name) {\n      state.headerName = name;\n    },\n\n    /**\r\n     * @description 设置当前所在菜单的 path，用于侧栏菜单高亮当前项\r\n     * @param {Object} state vuex state\r\n     * @param {Array} path fullPath\r\n     */\n    setActivePath: function setActivePath(state, path) {\n      state.activePath = path;\n    },\n\n    /**\r\n     * @description 设置当前所在菜单的全部展开父菜单的 names 集合\r\n     * @param {Object} state vuex state\r\n     * @param {Array} names openNames\r\n     */\n    setOpenNames: function setOpenNames(state, names) {\n      state.openNames = names;\n    },\n\n    /**\r\n     * @description 2.3.0，设置所有菜单\r\n     * @param {Object} state vuex state\r\n     * @param {Array} menuSider menuSider\r\n     * */\n    setMenuSider: function setMenuSider(state, menuSider) {\n      state.menuSider = menuSider;\n    }\n  }\n};",null]}