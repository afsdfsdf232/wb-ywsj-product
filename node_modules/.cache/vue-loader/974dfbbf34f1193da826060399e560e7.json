{"remainingRequest":"D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\node_modules\\iview-loader\\index.js??ref--0-2!D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\src\\layouts\\basic-layout\\header-user\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\src\\layouts\\basic-layout\\header-user\\index.vue","mtime":1623978686000},{"path":"D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1628602912197},{"path":"D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\node_modules\\babel-loader\\lib\\index.js","mtime":1628602899323},{"path":"D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1628602912197},{"path":"D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\node_modules\\vue-loader\\lib\\index.js","mtime":1628602913036},{"path":"D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\node_modules\\iview-loader\\index.js","mtime":1628602915515}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapState, mapActions } from 'vuex';\nimport util from '@/libs/util'\nexport default {\n    name: 'iHeaderUser',\n    data () {\n        return {\n            passwordModal: false,\n            infoFlag: false,\n            formValidate: {\n                password: '',\n                password1: '',\n                password2: ''\n            },\n            ruleValidate: {\n                password: [\n                    { required: true, message: '旧密码不能为空', trigger: 'blur' },\n                    { type: 'string', min: 6, message: '最小长度6位', trigger: 'blur' }\n                ],\n                password1: [\n                    { required: true, message: '新密码不能为空', trigger: 'blur' }\n                    // { type: 'string', min: 6, message: '最小长度6位', trigger: 'blur' }\n                ],\n                password2: [\n                    { required: true, message: '确认新密码不能为空', trigger: 'blur' },\n                    { type: 'string', min: 6, message: '最小长度6位', trigger: 'blur' }\n                ]\n            },\n            InfoValidate: {\n                staffName: '',\n                moblieNumber: '',\n                email: ''\n            },\n            InfRulesValidate: {\n                staffName: [\n                    { required: true, message: '用户名不能为空', trigger: 'blur' }\n                ],\n                moblieNumber: [\n                    { required: true, message: '手机号不能为空', trigger: 'blur' },\n                    { type: 'string', message: '手机号格式输入错误', trigger: 'blur', pattern: util.mobileReg }\n                ],\n                email: [\n                    { required: true, message: '邮箱不能为空', trigger: 'blur' },\n                    { type: 'string', message: '邮箱格式输入错误', trigger: 'blur', pattern: util.emailReg }\n                ]\n            }\n        }\n    },\n    computed: {\n        ...mapState('admin/user', [\n            'info'\n        ]),\n        ...mapState('admin/layout', [\n            'isMobile',\n            'logoutConfirm'\n        ])\n    },\n    methods: {\n        ...mapActions('admin/account', [\n            'logout'\n        ]),\n        submitBtn () {\n            this.$refs.formValidate.validate((valid) => {\n                if (valid) {\n                    this.$Message.success('Success!');\n                    this.passwordModal = false;\n                } else {\n                    this.$Message.error('请输入必填项');\n                }\n            })\n        },\n        // 保存信息\n        infoSaveBtn () {\n            this.$refs.InfoValidate.validate((valid) => {\n                if (valid) {\n                    util.ajax({\n                        data: {\n                            _call: 'im.imService.editMyData',\n                            params: this.InfoValidate\n                        }\n                    }).then(res => {\n                        if (res.output.flag) {\n                            this.$Message.success('修改成功');\n                            let info = {};\n                            Object.assign(info, this.info, this.InfoValidate);\n                            this.$store.dispatch('admin/user/set', info);\n                            this.infoFlag = false;\n                        }\n                    })\n                } else {\n                    this.$Message.error('请输入必填项');\n                }\n            })\n        },\n        handleClick (name) {\n            if (name === 'logout') {\n                this.logout({\n                    confirm: this.logoutConfirm,\n                    vm: this\n                });\n            } else if (name === 'center') {\n                // 重置表单\n                this.$refs.formValidate.resetFields();\n                this.passwordModal = true;\n            } else if (name === 'setting') {\n                this.$refs.InfoValidate.resetFields();\n                this.InfoValidate.staffName = this.info.staffName;\n                this.InfoValidate.moblieNumber = this.info.moblieNumber;\n                this.InfoValidate.email = this.info.email || '';\n                this.infoFlag = true;\n            }\n        }\n    },\n    mounted () {\n        console.log(this.info);\n        this.InfoValidate.staffName = this.info.staffName;\n        this.InfoValidate.moblieNumber = this.info.moblieNumber;\n        this.InfoValidate.email = this.info.email || '';\n        console.log('this.InfoValidate', this.InfoValidate)\n    }\n}\n",null]}