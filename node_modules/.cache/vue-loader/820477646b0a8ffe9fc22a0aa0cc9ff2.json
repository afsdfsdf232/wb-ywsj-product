{"remainingRequest":"D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\node_modules\\iview-loader\\index.js??ref--0-2!D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\src\\layouts\\basic-layout\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\src\\layouts\\basic-layout\\index.vue","mtime":1602575444000},{"path":"D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1628602912197},{"path":"D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\node_modules\\babel-loader\\lib\\index.js","mtime":1628602899323},{"path":"D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1628602912197},{"path":"D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\node_modules\\vue-loader\\lib\\index.js","mtime":1628602913036},{"path":"D:\\project\\WB\\d2\\免费领前端任务包\\ywsj-product\\node_modules\\iview-loader\\index.js","mtime":1628602915515}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport iMenuHead from './menu-head';\nimport iMenuSide from './menu-side';\nimport iHeaderLogo from './header-logo';\nimport iHeaderCollapse from './header-collapse';\nimport iHeaderReload from './header-reload';\nimport iHeaderBreadcrumb from './header-breadcrumb';\nimport iHeaderSearch from './header-search';\nimport iHeaderLog from './header-log';\nimport iHeaderFullscreen from './header-fullscreen';\nimport iHeaderNotice from './header-notice';\nimport iHeaderUser from './header-user';\nimport iHeaderI18n from './header-i18n';\nimport iHeaderSetting from './header-setting';\nimport iTabs from './tabs';\nimport iCopyright from '@/components/copyright';\n\nimport { mapState, mapGetters, mapMutations } from 'vuex';\nimport Setting from '@/setting';\n\nimport { requestAnimation } from '@/libs/util';\n\nexport default {\n    name: 'BasicLayout',\n    components: { iMenuHead, iMenuSide, iCopyright, iHeaderLogo, iHeaderCollapse, iHeaderReload, iHeaderBreadcrumb, iHeaderSearch, iHeaderUser, iHeaderI18n, iHeaderLog, iHeaderFullscreen, iHeaderSetting, iHeaderNotice, iTabs },\n    data () {\n        return {\n            showDrawer: false,\n            ticking: false,\n            headerVisible: true,\n            oldScrollTop: 0,\n            isDelayHideSider: false, // hack，当从隐藏侧边栏的 header 切换到正常 header 时，防止 Logo 抖动\n            loadRouter: true\n        }\n    },\n    computed: {\n        ...mapState('admin/layout', [\n            'siderTheme',\n            'headerTheme',\n            'headerStick',\n            'tabs',\n            'tabsFix',\n            'siderFix',\n            'headerFix',\n            'headerHide',\n            'headerMenu',\n            'isMobile',\n            'isTablet',\n            'isDesktop',\n            'menuCollapse',\n            'showMobileLogo',\n            'showSearch',\n            'showNotice',\n            'showFullscreen',\n            'showSiderCollapse',\n            'showBreadcrumb',\n            'showLog',\n            'showI18n',\n            'showReload',\n            'enableSetting'\n        ]),\n        ...mapState('admin/page', [\n            'keepAlive'\n        ]),\n        ...mapGetters('admin/menu', [\n            'hideSider'\n        ]),\n        // 如果开启 headerMenu，且当前 header 的 hideSider 为 true，则将顶部按 headerStick 处理\n        // 这时，即使没有开启 headerStick，仍然按开启处理\n        isHeaderStick () {\n            let state = this.headerStick;\n            if (this.hideSider) state = true;\n            return state;\n        },\n        showHeader () {\n            let visible = true;\n            if (this.headerFix && this.headerHide && !this.headerVisible) visible = false;\n            return visible;\n        },\n        headerClasses () {\n            return [\n                `i-layout-header-color-${this.headerTheme}`,\n                {\n                    'i-layout-header-fix': this.headerFix,\n                    'i-layout-header-fix-collapse': this.headerFix && this.menuCollapse,\n                    'i-layout-header-mobile': this.isMobile,\n                    'i-layout-header-stick': this.isHeaderStick && !this.isMobile,\n                    'i-layout-header-with-menu': this.headerMenu,\n                    'i-layout-header-with-hide-sider': this.hideSider || this.isDelayHideSider\n                }\n            ];\n        },\n        headerStyle () {\n            const menuWidth = this.isHeaderStick ? 0 : this.menuCollapse ? 80 : Setting.menuSideWidth;\n            return this.isMobile || !this.headerFix ? {} : {\n                width: `calc(100% - ${menuWidth}px)`\n            };\n        },\n        siderClasses () {\n            return {\n                'i-layout-sider-fix': this.siderFix,\n                'i-layout-sider-dark': this.siderTheme === 'dark'\n            };\n        },\n        contentClasses () {\n            return {\n                'i-layout-content-fix-with-header': this.headerFix,\n                'i-layout-content-with-tabs': this.tabs,\n                'i-layout-content-with-tabs-fix': this.tabs && this.tabsFix\n            };\n        },\n        insideClasses () {\n            return {\n                'i-layout-inside-fix-with-sider': this.siderFix,\n                'i-layout-inside-fix-with-sider-collapse': this.siderFix && this.menuCollapse,\n                'i-layout-inside-with-hide-sider': this.hideSider,\n                'i-layout-inside-mobile': this.isMobile\n            };\n        },\n        drawerClasses () {\n            let className = 'i-layout-drawer';\n            if (this.siderTheme === 'dark') className += ' i-layout-drawer-dark';\n            return className;\n        },\n        menuSideWidth () {\n            return this.menuCollapse ? 80 : Setting.menuSideWidth;\n        }\n    },\n    watch: {\n        hideSider () {\n            this.isDelayHideSider = true;\n            setTimeout(() => {\n                this.isDelayHideSider = false;\n            }, 0);\n        },\n        '$route' (to, from) {\n            if (to.name === from.name) {\n                // 相同路由，不同参数，跳转时，重载页面\n                if (Setting.sameRouteForceUpdate) {\n                    this.handleReload();\n                }\n            }\n        }\n    },\n    methods: {\n        ...mapMutations('admin/layout', [\n            'updateMenuCollapse'\n        ]),\n        ...mapMutations('admin/page', [\n            'keepAlivePush',\n            'keepAliveRemove'\n        ]),\n        handleToggleDrawer (state) {\n            if (typeof state === 'boolean') {\n                this.showDrawer = state;\n            } else {\n                this.showDrawer = !this.showDrawer;\n            }\n        },\n        handleScroll () {\n            if (!this.headerHide) return;\n\n            const scrollTop = document.body.scrollTop + document.documentElement.scrollTop;\n\n            if (!this.ticking) {\n                this.ticking = true;\n                requestAnimation(() => {\n                    if (this.oldScrollTop > scrollTop) {\n                        this.headerVisible = true;\n                    } else if (scrollTop > 300 && this.headerVisible) {\n                        this.headerVisible = false;\n                    } else if (scrollTop < 300 && !this.headerVisible) {\n                        this.headerVisible = true;\n                    }\n                    this.oldScrollTop = scrollTop;\n                    this.ticking = false;\n                });\n            }\n        },\n        handleHeaderWidthChange () {\n            const $breadcrumb = this.$refs.breadcrumb;\n            if ($breadcrumb) {\n                $breadcrumb.handleGetWidth();\n                $breadcrumb.handleCheckWidth();\n            }\n            const $menuHead = this.$refs.menuHead;\n            if ($menuHead) {\n                // todo $menuHead.handleGetMenuHeight();\n            }\n        },\n        handleReload () {\n            // 针对缓存的页面也生效\n            const isCurrentPageCache = this.keepAlive.indexOf(this.$route.name) > -1;\n            const pageName = this.$route.name;\n            if (isCurrentPageCache) {\n                this.keepAliveRemove(pageName);\n            }\n            this.loadRouter = false;\n            this.$nextTick(() => {\n                this.loadRouter = true;\n                if (isCurrentPageCache) {\n                    this.keepAlivePush(pageName);\n                }\n            });\n        }\n    },\n    mounted () {\n        document.addEventListener('scroll', this.handleScroll, { passive: true });\n    },\n    beforeDestroy () {\n        document.removeEventListener('scroll', this.handleScroll);\n    },\n    created () {\n        if (this.isTablet && this.showSiderCollapse) this.updateMenuCollapse(true);\n    }\n}\n",null]}